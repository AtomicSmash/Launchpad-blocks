(function(d,o){if(typeof exports=="object"&&typeof module=="object")module.exports=o();else if(typeof define=="function"&&define.amd)define([],o);else{var l=o();for(var a in l)(typeof exports=="object"?exports:d)[a]=l[a]}})(globalThis,()=>(()=>{"use strict";var r={};r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var d={};const o=window.wp.domReady;var l=r.n(o);function a(t,e){const{timeout:i,...c}={timeout:1e4,...e};return new Promise((s,h)=>{const n=()=>{t.removeEventListener("scrollend",n),s()};t.scrollTo(c),t.addEventListener("scrollend",n),setTimeout(()=>{t.removeEventListener("scrollend",n),h(new Error("Scroll to event timed out."))},i)})}class u{userPrefersReducedMotion=!0;banner;scrollContainer;imagesContainer;initiallyVisibleItems=[];scrollbarWidth;initiallyVisibleImagesObserver=null;debounceResizeTimeout=void 0;currentScrollPosition=0;scrollOffset=0;scrollInterval=void 0;constructor(e){this._setUserPrefersReducedMotion(this._getUserPrefersReducedMotion()),this._attachPrefersReducedMotionListener(),this.banner=e,this.scrollContainer=this.banner.querySelector("div.scroll-container"),this.imagesContainer=this.scrollContainer.querySelector(":scope > div.images"),this.scrollbarWidth=this.scrollContainer.offsetHeight-this.scrollContainer.clientHeight,document.readyState==="complete"?this.initialiseBanner().catch(()=>{throw new Error("Failed to initialise banner.")}):document.addEventListener("readystatechange",()=>{document.readyState==="complete"&&this.initialiseBanner().catch(()=>{throw new Error("Failed to initialise banner.")})}),window.addEventListener("resize",()=>{clearTimeout(this.debounceResizeTimeout),this.debounceResizeTimeout=setTimeout(()=>{this.reinitialiseBanner()},100)})}_attachPrefersReducedMotionListener(){window.matchMedia("(prefers-reduced-motion: reduce)").addEventListener("change",()=>{this._setUserPrefersReducedMotion(this._getUserPrefersReducedMotion())})}_getUserPrefersReducedMotion(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}_setUserPrefersReducedMotion(e){this.userPrefersReducedMotion=e}async initialiseBanner(){this.scrollContainer.style.marginBlockEnd=`-${this.scrollbarWidth}px`,await this.getInitiallyVisibleImages().then(()=>{this.imagesContainer.append(...this.initiallyVisibleItems),this.scrollOffset=this.scrollContainer.offsetLeft,this.scrollInterval=setInterval(()=>{const e=this.imagesContainer.querySelectorAll(".wp-block-image")[this.currentScrollPosition+1];if(!e)throw clearInterval(this.scrollInterval),new Error("Expected element, but received undefined.");a(this.scrollContainer,{left:e.offsetLeft-this.scrollOffset,behavior:this.userPrefersReducedMotion?"instant":"smooth",timeout:2e3}).then(()=>{++this.currentScrollPosition,this.imagesContainer.querySelectorAll(".wp-block-image")[this.currentScrollPosition].classList.contains("overflow-item")&&(this.scrollContainer.scrollTo({left:0,behavior:"instant"}),this.currentScrollPosition=0)}).catch(()=>{throw clearInterval(this.scrollInterval),new Error("Scroll by timed out.")})},3e3)})}cleanupBanner(){this.resetGallery(),this.scrollOffset=0,this.currentScrollPosition=0,this.initiallyVisibleImagesObserver?.disconnect(),this.initiallyVisibleImagesObserver=null,clearInterval(this.scrollInterval)}reinitialiseBanner(){this.cleanupBanner(),this.initialiseBanner().catch(()=>{throw new Error("Failed to re-initialise banner.")})}async getInitiallyVisibleImages(){return new Promise(e=>{const i=this.imagesContainer.querySelectorAll(".wp-block-image"),c=[];this.initiallyVisibleImagesObserver??=new IntersectionObserver((s,h)=>{i.length===s.length&&(s.forEach(n=>{n.isIntersecting&&c.push(n.target)}),this.initiallyVisibleImagesObserver.disconnect(),e(c))},{root:this.imagesContainer});for(const s of i)this.initiallyVisibleImagesObserver.observe(s)}).then(e=>{this.initiallyVisibleItems=e.map(i=>(i=i.cloneNode(!0),i.classList.add("overflow-item"),i))})}resetGallery(){this.initiallyVisibleItems=[],this.imagesContainer.replaceChildren(...this.imagesContainer.querySelectorAll(".wp-block-image:not(.overflow-item)"))}}return l()(()=>{const t=document.querySelectorAll('[data-launchpad-logo-banner][data-is-scrolling="true"]');for(const e of t)new u(e)}),d})());
